simulation:
  name: "follow_line_traj"
  timestep: 0.03  # max 0.05s before simulation crashes
  end_time: 40.0
  graphical: true
  save_csv: false
  save_output: results/
  show_graphs: false
  save_graphs: false


robot:
  name: bluerov2

  mission:
    type: trajectory
    params:
      # waypoints:
      #   - [0, 0, 10, 0, 0, 0]
      #   - [10, 0, 10, 0, 0, 0]
      #   - [20, 5, 10, 0, 0, 0]
      #   - [30, -5, 10, 0, 0, 0]
      #   - [40, 5, 10, 0, 0, 0]
      # times:
      #   - 0
      #   - 15
      #   - 30
      #   - 45
      #   - 60
      waypoints:
        - [0, 0, 10, 0, 0, 0]
        - [5, 0, 15, 0, 0, 0]
        - [5, 5, 20, 0, 0, 0]
        - [0, 5, 10, 0, 0, 0]
        - [0, 0, 10, 0, 0, 0]
      times:
        - 0
        - 10
        - 20
        - 30
        - 40


  initial_conditions:
    eta: [0, 0, 10, 0, 0, 0]
    nu: [0, 0, 0, 0, 0, 0]

  mass_properties:
    m: 11.5
    rg: [0.0, 0.0, 0.02]
    I0:
      - [0.16, 0.00, 0.00]
      - [0.00, 0.16, 0.00]
      - [0.00, 0.00, 0.16]
    Ma:
      - [5.5, 0, 0, 0, 0, 0]
      - [0, 12.7, 0, 0, 0, 0]
      - [0, 0, 14.57, 0, 0, 0]
      - [0, 0, 0, 0.12, 0, 0]
      - [0, 0, 0, 0, 0.12, 0]
      - [0, 0, 0, 0, 0, 0.12]

  damping:
    Dl:
      - [4.03, 0, 0, 0, 0, 0]
      - [0, 6.22, 0, 0, 0, 0]
      - [0, 0, 5.18, 0, 0, 0]
      - [0, 0, 0, 0.07, 0, 0]
      - [0, 0, 0, 0, 0.07, 0]
      - [0, 0, 0, 0, 0, 0.07]
    Dq:
      - [18.18, 0, 0, 0, 0, 0]
      - [0, 21.66, 0, 0, 0, 0]
      - [0, 0, 36.99, 0, 0, 0]
      - [0, 0, 0, 1.55, 0, 0]
      - [0, 0, 0, 0, 1.55, 0]
      - [0, 0, 0, 0, 0, 1.55]

  thrusters:
    n_thrusters: 8
      # -----------------------------------------------------
      #  HORIZONTAL THRUSTERS (VECTOR 30°)
      #  Positions approximate official CAD center-of-thrust
      # -----------------------------------------------------
    thruster0:
      name: HFR  # Horizontal Front Right
      position: [ 0.140,  0.104, 0.066, 0.0, 0.0,  -0.523599 ]   # +30°
      thrust_limits: [-35, 45]
      wn: 20
      zeta: 0.7

    thruster1:
      name: HFL  # Horizontal Front Left
      position: [ 0.140, -0.104, 0.066, 0.0, 0.0, 0.523599 ]   # -30°
      thrust_limits: [-35, 45]
      wn: 20
      zeta: 0.7

    thruster2:
      name: HRR  # Horizontal Rear Right
      position: [ -0.140,  0.104, 0.066, 0.0, 0.0,  -2.617994 ]  # -150°
      thrust_limits: [-35, 45]
      wn: 20
      zeta: 0.7

    thruster3:
      name: HRL  # Horizontal Rear Left
      position: [ -0.140, -0.104, 0.066, 0.0, 0.0, 2.617994 ]  # +150°
      thrust_limits: [-35, 45]
      wn: 20
      zeta: 0.7

    # -----------------------------------------------------
    #  VERTICAL THRUSTERS (HEAVY UPGRADE: 4 VERTICAL MOTORS)
    #  Positioned at the 4 corners of the frame
    #  Pitch = -90° because using XYZ Euler → thrust DOWN
    # -----------------------------------------------------
    thruster4:
      name: VFR  # Vertical Front Right
      position: [ 0.120,  0.218, 0.003,  0.0, -1.5708, 0.0 ]   # down
      thrust_limits: [-35, 45]
      wn: 20
      zeta: 0.7

    thruster5:
      name: VFL  # Vertical Front Left
      position: [ 0.120, -0.218, 0.003,  0.0, -1.5708, 0.0 ]
      thrust_limits: [-35, 45]
      wn: 20
      zeta: 0.7

    thruster6:
      name: VRR  # Vertical Rear Right
      position: [ -0.120,  0.218, 0.003, 0.0, -1.5708, 0.0 ]
      thrust_limits: [-35, 45]
      wn: 20
      zeta: 0.7

    thruster7:
      name: VRL  # Vertical Rear Left
      position: [ -0.120, -0.218, 0.003, 0.0, -1.5708, 0.0 ]
      thrust_limits: [-35, 45]
      wn: 20
      zeta: 0.7

  controller:
    type: FDB
    # type: SMC
    # type: PID
    # type: MPC

    eta_tol: [0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
    nu_tol: [0.05, 0.05, 0.05, 0.05, 0.05, 0.05]
    cmd_offset: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    
    smc_params:
      k_smc: [16.0, 16.0, 2.0, 1.0, 3.0, 2.0]
      phi: [0.8, 0.8, 0.8, 0.8, 0.8, 0.8]
      lambda_smc: [1.0, 1.0, 2.5, 2.0, 2.0, 2.0]
    feedback_params:
      kp: [0.4, 0.4, 0.2, 0.7, 0.7, 0.6]
      kd: [2.0, 2.0, 2.0, 1.0, 1.0, 1.0]
      noises: { D: 0.0, C: 0.0, G: 0.0, M: 0.0 }
      # noises: { D: 0.1, C: 0.1, G: 0.05, M: 0.2 }
    mpc_params:
      k: [40.0, 40.0, 40.0, 1.0, 1.0, 40.0]
    pid_params:
      kp: [3.0, 3.0, 3.0, 4.0, 4.0, 2.0]
      ki: [0.2, 0.2, 0.2, 0.3, 0.3, 0.1]
      kd: [2.5, 2.5, 0.5, 0.5, 1.0, 0.5]


# Environment parameters
environment:
  # Open water parameters
  properties:
    gravity: [0.0, 0.0, -9.81]  # Gravity vector in m/s^2
    water_density: 1025.0        # Density of water in kg/m^3
    water_viscosity: 1.0e-3      # Viscosity of water in Pa.s

  current:
    types: depth_profile  # Options: zero, normal, jet, constant, time_series, depth_profile

    # Type: normal (randomized per axis)
    normal:
      speed: [0.3, -0.3, 0.0, 0.0, 0.0, 0.0]
      std: [0.10, 0.05, 0.00, 0.0, 0.0, 0.0]

    # Type: jet (fully fixed 6D vector)
    jet:
      vector: [0.3, 0.0, 0.0, 0.0, 0.0, 0.0]
      period: 10
      duty: 0.1

    # Type: constant (3D only, angular assumed zero)
    constant:
      vector: [0.0, 0.0, 0.0]

    # Type: time_series (indexed array of 6D vectors)
    time_series:
      - time: 0
        vector: [0.1, 0.0, 0.0, 0.0, 0.0, 0.0]
      - time: 20
        vector: [0.15, 0.05, 0.0, 0.0, 0.0, 0.0]
      - time: 100
        vector: [0.2, 0.0, 0.0, 0.0, 0.0, 0.0]

    # Type: depth_profile (velocity as a function of depth)
    depth_profile:
      - depth: 0
        vector: [0.8, 0.0, 0.0, 0.0, 0.0, 0.0]
      - depth: 10
        vector: [0.4, 0.0, 0.0, 0.0, 0.0, 0.0]
      - depth: 20
        vector: [0.1, 0.0, 0.0, 0.0, 0.0, 0.0]
